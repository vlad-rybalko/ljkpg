import{d as D,o as v,c as m,h as w,_ as b,Z as A,a as k,g as y,W as B}from"./index-9YruqIoT.js";const H={class:"widget-text"},z={key:0,class:"placeholder"},J=["innerHTML"],L=D({__name:"WidgetText",props:{content:{default:""}},setup(t){const r=t,f=w(()=>!r.content||r.content==="<p></p>");return(g,h)=>(v(),m("div",H,[f.value?(v(),m("div",z,"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚...")):(v(),m("div",{key:1,innerHTML:r.content},null,8,J))]))}}),Y=b(L,[["__scopeId","data-v-dfbdb2ba"]]),G=["src","alt"],K=D({__name:"WidgetImage",props:{src:{default:"https://via.placeholder.com/400x300"},alt:{default:"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"},objectFit:{default:"cover"},width:{default:"100%"},height:{default:"auto"}},setup(t){const r=t;function f(c){return!c||c==="auto"?"auto":typeof c=="number"?`${c}px`:/^\d+$/.test(c)?`${c}px`:c}const g=w(()=>{const c={};return c.width=f(r.width),r.height&&r.height!=="auto"&&(c.height=f(r.height)),c}),h=w(()=>{const c=r.height&&r.height!=="auto";return{objectFit:r.objectFit,width:"100%",height:c?"100%":"auto"}});return(c,x)=>(v(),m("div",{class:"widget-image-container",style:A(g.value)},[k("img",{src:r.src,alt:r.alt,style:A(h.value),class:"widget-image"},null,12,G)],4))}}),V=b(K,[["__scopeId","data-v-f5d762a0"]]),U={text:Y,image:V},X=[{type:"text",label:"Ð¢ÐµÐºÑÑ‚",icon:"T",defaultProps:{content:""}},{type:"image",label:"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ",icon:"ðŸ–¼",defaultProps:{src:"https://via.placeholder.com/400x300",alt:"",objectFit:"cover",width:"100%",height:"auto"}}],P="page-builder-pages";function p(){return Math.random().toString(36).substring(2,11)}function Z(){try{const t=localStorage.getItem(P);return t?JSON.parse(t):[]}catch{return[]}}function q(t){localStorage.setItem(P,JSON.stringify(t))}const l=y(Z()),_=y(null);B(l,t=>{q(t)},{deep:!0});function tt(){const t=w(()=>_.value&&l.value.find(e=>e.id===_.value)||null),r=w(()=>t.value?.content||{rows:[]});function f(){return l.value}function g(e){return l.value.find(n=>n.id===e)}function h(e){const n={id:p(),name:e,content:{rows:[]},createdAt:Date.now(),updatedAt:Date.now()};return l.value.push(n),n}function c(e,n){const o=l.value.find(i=>i.id===e);o&&(o.name=n,o.updatedAt=Date.now())}function x(e){const n=l.value.findIndex(o=>o.id===e);n!==-1&&l.value.splice(n,1)}function C(e){_.value=e}function E(){return r.value}function I(e){t.value&&(t.value.content=e,t.value.updatedAt=Date.now())}function S(){t.value&&(t.value.content={rows:[]},t.value.updatedAt=Date.now())}function W(){if(!t.value)throw new Error("No page selected");const e={id:p(),columns:[{id:p(),width:12,widgets:[]}],gapX:16,gapY:16};return t.value.content.rows.push(e),t.value.updatedAt=Date.now(),e}function N(e,n){if(!t.value)return;const o=t.value.content.rows.find(i=>i.id===e);o&&(Object.assign(o,n),t.value.updatedAt=Date.now())}function j(e){if(!t.value)return;const n=t.value.content.rows.findIndex(o=>o.id===e);n!==-1&&(t.value.content.rows.splice(n,1),t.value.updatedAt=Date.now())}function R(e){if(!t.value)throw new Error("No page selected");const n=t.value.content.rows.find(u=>u.id===e);if(!n)throw new Error("Row not found");const o={id:p(),width:6,widgets:[]};n.columns.push(o);const i=n.columns.length,a=Math.floor(12/i);return n.columns.forEach(u=>{u.width=a}),t.value.updatedAt=Date.now(),o}function T(e,n,o){if(!t.value)return;const i=t.value.content.rows.find(u=>u.id===e);if(!i)return;const a=i.columns.find(u=>u.id===n);a&&(Object.assign(a,o),t.value.updatedAt=Date.now())}function F(e,n){if(!t.value)return;const o=t.value.content.rows.find(a=>a.id===e);if(!o)return;const i=o.columns.findIndex(a=>a.id===n);if(i!==-1&&o.columns.length>1){o.columns.splice(i,1);const a=o.columns.length,u=Math.floor(12/a);o.columns.forEach(d=>{d.width=u}),t.value.updatedAt=Date.now()}}function M(e,n,o){if(!t.value)throw new Error("No page selected");const i=t.value.content.rows.find(s=>s.id===e);if(!i)throw new Error("Row not found");const a=i.columns.find(s=>s.id===n);if(!a)throw new Error("Column not found");const u=X.find(s=>s.type===o),d={id:p(),type:o,props:u?{...u.defaultProps}:{}};return a.widgets.push(d),t.value.updatedAt=Date.now(),d}function O(e,n,o,i){if(!t.value)return;const a=t.value.content.rows.find(s=>s.id===e);if(!a)return;const u=a.columns.find(s=>s.id===n);if(!u)return;const d=u.widgets.find(s=>s.id===o);d&&(d.props={...d.props,...i},t.value.updatedAt=Date.now())}function $(e,n,o){if(!t.value)return;const i=t.value.content.rows.find(d=>d.id===e);if(!i)return;const a=i.columns.find(d=>d.id===n);if(!a)return;const u=a.widgets.findIndex(d=>d.id===o);u!==-1&&(a.widgets.splice(u,1),t.value.updatedAt=Date.now())}return{pages:l,currentPage:t,content:r,getAllPages:f,getPage:g,createPage:h,updatePageName:c,deletePage:x,setCurrentPage:C,getContent:E,setContent:I,clearContent:S,addRow:W,updateRow:N,deleteRow:j,addColumn:R,updateColumn:T,deleteColumn:F,addWidget:M,updateWidget:O,deleteWidget:$,generateId:p}}export{U as a,tt as u,X as w};
